# Алгоритмы и структуры данных, ДЗ №4

Новожилов Дмитрий, гр. 504

done: 1, 2, 4, 5
left: 3, 7*, 8*

---

## №1

Спускаемся по куче, формируя массив, в который входит масимальный из детей в текущем поддереве (из поддерева спускаемся в его максимального ребенка). На это уходит $O(\log_2n)$ сравнений -- высота кучи. После этого двочиным поиском ищем место в этом массиве, куда надо вставить элемент, для которого применяется `SiftUp`, после чего вставляем его туда, а все элементы больше него сдвигаем по дереву вверх.

## №2

1. Дополняем массив бесконечностями так, чтобы его длина стала степенью двойки.
2. Фиксируем длины сортируемых кусков `k = 1`
3. Записываем первую половину массива в один файл, вторую во второй.
4. Сливаем из этих файлов кусочки размера `k` в исходный файл.
5. Увеличиваем `k` в два раза, если `k` меньше длины массива, перейти к шагу 2.
6. Удаляем из отсортированного массива бесконечности.

## №4

1. $\frac d {dq} \sum \limits_{i=1}^n w_i |p_i - q| = \sum\limits_{i=1}^k w_i - \sum\limits_{i=k+1}^n w_i, \ \ p_k \leq q \leq p_{k+1} \ \ (1)$. Это неубывающая кусочно линейная функция (на каждом отрезке она константна). Т.к. ищется минимум исходного выражения, надо найти q, при котором производная наиболее близка к нулю.
Составим массив частичных сумм $v_i = \sum\limits_{j=1}^i w_j$.
    Тогда $\sum\limits_{i=1}^k w_i = v_i$, $\sum\limits_{i=k+1}^n w_i = v_n - v_i$, и выражение $(1)$ принимает форму $2v_i - v_n$. Остается найти минимум этого выражения, что делается за один проход по массиву $v$. Когда найден индекс $k$, соотвествующий минимуму, можно выбрать $q = (p_k + p_{k + 1}) / 2$.
2. $\frac d {dq} \sum \limits_{i=1}^n w_i (p_i - q)^2 = 2 \left(\sum \limits_{i=1}^n w_i p_i - \sum \limits_{i=1}^n w_i q\right) = 2(S - Wq) = 0$. Отсюда $q = \left(\sum \limits_{i=1}^nw_ip_i\right) / \left(\sum \limits_{i=1}^n w_i\right)$.

## №5

1. Храним очередь в двоичной куче (вставказа $O(\log n)$). При удалении максимума просто переподвешиваем кучу за максимального ребенка корня. Раз за $k$ операций удаления выполняем балансировку. Таким образом амортизированное время удаления максимума будет $O(1)$.
2. Фиббоначиева куча -- набор из подвешенных деревьев, удовлетворяющих свойству кучи. Она поддерживает операцию вставки за $O(1)$ и операцию удаления максимума за $O(\log n)$.
