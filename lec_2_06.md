# Линейное программирование

Рассмотрим два товара $A$ и $B$. Их стоимости $P(A) = 1$, $P(B)=6$. Рассмотрим производство за день:
* $x_1 = \# A$, $P(A) = 1$
* $x_2 = \# B$, $P(B) = 6$
* $x_1\leq 200$
* $x_2\leq 300$
* $x_1+x_2\leq 400$
* $x_1, x_2\geq 0$
* Цель: $x_1+6x_2\rightarrow\max$, произвести товара на наибольшую стоимость.

Получили некоторую задачу минимизации/максимизации с линейными ограничениями.

Дальше строится красивая картинка, на которой мы в пространстве $x_1, x_2$ рисуем отображение этой системы.

<span style="color:red">TODO: добавить картинку</span>

Любая такая система ограничений даст выпуклую область, т.к. любое ограничение ограничивает полуплоскость, а пересечение полуплоскостей -- выпукло.

Максимум целевой функции всегда будет достигаться на границе области, более того, на какой-то вершине.

Добавим третий товар:
* $x_1 = \# A$, $P(A) = 1$
* $x_2 = \# B$, $P(B) = 6$
* $x_3 = \# C$, $P(C) = 13$
* $x_1\leq 200$
* $x_2\leq 300$
* $x_2+3x_3\leq 400$
* $x_1, x_2, x_3\geq 0$
* Цель: $x_1+6x_2+13\rightarrow\max$

<span style="color:red">TODO: добавить страшную трехмерную картинку</span>

**Общие для всех размерностей замечания:**
* Область возможных решений (ОВР) выпуклая, полиэдр (дофигагранник)
* Условие, которое максимизируется(минимизируется) задает гиперплоскость размерности $n$
* Решение (оптимум) достигается в вершине (ОВР), в которой решение касается полиэдра

## Общий подход к решению (симплекс метод)

1. Начнем в некоторой вершине из ОВР
2. Пока есть соседняя (по ребрам полиэдра) вершина с лучшим значением, переходим в эту вершину
3. Если нашли вершину, у которой целевая функция во всех соседних вершинах хуже, значит мы нашли ответ (это правда, т.к. выпуклость решает)

Если у нас $m$ неравенств и $n$ переменных, тогда в полиэдре будет порядка ${m\choose n}$ вершин. Если $m = 2n$, то ${m\choose n} = {2n\choose n} \sim 2^n$, что плохонько.

**Итого:** симплекс метод может работать экспоненциально долго, однако на практике он работает за адекватное время. При этом существует сложный алгоритм, дающий гарантированное полиномиальное время.

## Формы записи ЛП

1. Ограничения:
    * равенства
    * неравенства
2. Переменные:
    * неотрицательные
    * произвольные
3. $\min/\max$

### Конвертация ограничений

* Равенство $\rightarrow$ неравенство: заменяем одно $=$ на два неравенства: $\leq$ и $\geq$
* Неравенство $\rightarrow$ равенство: вводим фиктивную переменную:
    $a_1x_1+...\leq b$
    $a_1x_1+...+s = b,\ \ s\geq 0$
* Произвольное $\rightarrow$ неотрицательная:
    $x_i$ -- произвольная
    $x_i = x_i' - x_i'', \ \ x_i', x_i''\geq 0$
* Минимум в максимум и наоборот конвертируются через домножения на $-1$

### Матричный вид

Матричный вид-- стандартное предстваление ЛП в виде матрицы $A\vec x\leq \vec b$, ограничение $x_i\geq 0$. В этих ограничениях максимизируется произведение $\vec c^T \vec x\rightarrow \max$.

## Двойственность

Из системы ограничений можно получить ограничение на целевую функцию, из которого находится ответ. Это можно сделать, разложив целевую функцию по базису из некоторых ограничений.

Таким образом, если мы максимизируем целевую функцию, то тогда мы минимизируем оценку из системы ограничений, таким образом получается минимаксная задача (<i>привет Омельченко</i>) и еще одна линейная задача, но уже на минимизацию.

Из разложения целевой функции по базису получается СЛАУ, определяемая целевой функцией, которую можно решить и получить ответ. Проблема с этим в том, что ограничений $m$, а в базисе $n$ ограничений, т.о. различных базисов получается ${m\choose n}$.

Если рассмотреть это все в матричном предствалении, то:
* $A \rightarrow A^T$
* $\vec b \rightarrow \vec c$
* $\vec c \rightarrow \vec b$
* $\max \rightarrow \min$
* $A\vec x \leq \vec b \rightarrow A^T\vec y\geq \vec c$

### Лемма Форкаша

**Лемма:**
* если существует решение прямой задачи, следовательно существует решение двойственной, и они равны.
* если прямая задача несовместна, то двойственная неограничена
* если прямая неограничена, то двойственная несовместна

## Задача ILP (Integer LP)

Задача -- найти решение ЛП в целых числах. Данная задача является $NP$-полной.

Иногда требуется доказать, что задача LP имеет целочисленное решение.

**Вопрос:** для каких $A$ система $A\vec x = \vec b$ имеет решение при любых целочисленных $b$.
**Ответ:** когда $\det(A) = \pm 1$. Такие матрицы называются унимодулярными.

Тотальная унимодулярность -- для любой квадратный подматрицы $M'$ матрицы $M$: $\det(M') \in {-1, 0, 1}$
